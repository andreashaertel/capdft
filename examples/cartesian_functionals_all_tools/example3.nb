(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 13.0' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[     28807,        706]
NotebookOptionsPosition[     27516,        679]
NotebookOutlinePosition[     27912,        695]
CellTagsIndexPosition[     27869,        692]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell[BoxData[{
 RowBox[{
  RowBox[{"count", " ", "=", " ", "20"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"potential", " ", "=", " ", "0."}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"diag", " ", "=", " ", 
   RowBox[{"ConstantArray", "[", 
    RowBox[{
     RowBox[{"-", "2"}], ",", "count"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"upper", " ", "=", " ", 
   RowBox[{"ConstantArray", "[", 
    RowBox[{"1", ",", 
     RowBox[{"count", "-", "1"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"lower", " ", "=", " ", 
   RowBox[{"ConstantArray", "[", 
    RowBox[{"1", ",", 
     RowBox[{"count", "-", "1"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"MDiag", " ", "=", " ", 
   RowBox[{"DiagonalMatrix", "[", "diag", "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"MUpper", " ", "=", " ", 
   RowBox[{"DiagonalMatrix", "[", 
    RowBox[{"upper", ",", "1"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"MLower", " ", "=", " ", 
   RowBox[{"DiagonalMatrix", "[", 
    RowBox[{"lower", ",", 
     RowBox[{"-", "1"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"FDiff1D", " ", "=", " ", 
   RowBox[{"MDiag", " ", "+", " ", "MUpper", " ", "+", " ", "MLower"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"diag", " ", "=", " ", 
   RowBox[{"ConstantArray", "[", 
    RowBox[{
     RowBox[{"-", "2"}], ",", 
     RowBox[{"count", "+", "2"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"upper", " ", "=", " ", 
   RowBox[{"ConstantArray", "[", 
    RowBox[{"1", ",", 
     RowBox[{"count", "+", "1"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"lower", " ", "=", " ", 
   RowBox[{"ConstantArray", "[", 
    RowBox[{"1", ",", 
     RowBox[{"count", "+", "1"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"MDiag", " ", "=", " ", 
   RowBox[{"DiagonalMatrix", "[", "diag", "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"MUpper", " ", "=", " ", 
   RowBox[{"DiagonalMatrix", "[", 
    RowBox[{"upper", ",", "1"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"MLower", " ", "=", " ", 
   RowBox[{"DiagonalMatrix", "[", 
    RowBox[{"lower", ",", 
     RowBox[{"-", "1"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"FDiff1D2", " ", "=", " ", 
   RowBox[{"MDiag", " ", "+", " ", "MUpper", " ", "+", " ", "MLower"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"MatrixForm", "[", "FDiff1D", "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"MatrixForm", "[", "FDiff1D2", "]"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{"rhs", " ", "=", " ", 
  RowBox[{"Join", "[", 
   RowBox[{
    RowBox[{"PadRight", "[", 
     RowBox[{
      RowBox[{"PadLeft", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"-", "1."}], ",", 
          RowBox[{"-", "1."}]}], "}"}], ",", " ", "3", ",", " ", "0."}], 
       "]"}], ",", 
      RowBox[{"count", " ", "-", " ", "3"}], ",", " ", "0."}], "]"}], ",", 
    " ", 
    RowBox[{"{", 
     RowBox[{"1.", ",", "1.", ",", "0."}], "}"}]}], 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"rhs", " ", "=", " ", 
    RowBox[{"rhs", " ", "-", " ", 
     RowBox[{"PadRight", "[", 
      RowBox[{
       RowBox[{"PadRight", "[", 
        RowBox[{
         RowBox[{"{", "potential", "}"}], ",", " ", 
         RowBox[{"count", " ", "-", " ", "1"}], ",", " ", "0."}], "]"}], ",", 
       " ", "count", ",", " ", 
       RowBox[{"-", "potential"}]}], "]"}]}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{"solution1", " ", "=", " ", 
  RowBox[{"LinearSolve", "[", 
   RowBox[{"FDiff1D", ",", " ", "rhs"}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{"ListPlot", "[", "solution1", "]"}]}], "Input",
 CellChangeTimes->{{3.8763851940848494`*^9, 3.8763852133167*^9}, {
   3.8763852578125877`*^9, 3.87638560765775*^9}, {3.876385688140238*^9, 
   3.876385953930937*^9}, {3.876386002143834*^9, 3.876386055498746*^9}, {
   3.876391943004149*^9, 3.876392036179655*^9}, {3.876392080581684*^9, 
   3.8763921288182364`*^9}, {3.876392170290761*^9, 3.876392188682002*^9}, {
   3.876392227513633*^9, 3.8763923542741413`*^9}, {3.876392395012867*^9, 
   3.876392395698102*^9}, {3.876392474916567*^9, 3.876392513017107*^9}, {
   3.876392585882358*^9, 3.8763925898340063`*^9}, {3.876392664658292*^9, 
   3.876392674104651*^9}, {3.876393056309846*^9, 3.8763930845115957`*^9}, {
   3.876393119993041*^9, 3.876393213551386*^9}, {3.876393881760839*^9, 
   3.876393881869561*^9}, {3.877060925835662*^9, 3.877060945081661*^9}, {
   3.87706098083357*^9, 3.87706098093736*^9}, {3.877061082817018*^9, 
   3.877061087016926*^9}, {3.8770611539642487`*^9, 3.87706122929566*^9}, {
   3.87706285044242*^9, 3.877062850904335*^9}, {3.877064666408894*^9, 
   3.8770646679518213`*^9}, 3.877074602029377*^9, {3.877075717450293*^9, 
   3.8770757182967052`*^9}, {3.880105491129656*^9, 3.8801055072857227`*^9}, {
   3.880105823780402*^9, 3.8801058302523603`*^9}, {3.8801061012195597`*^9, 
   3.880106101307209*^9}, {3.880106274130856*^9, 3.8801063237383547`*^9}, {
   3.880107409302595*^9, 3.880107410014475*^9}, {3.880172436195084*^9, 
   3.880172436873007*^9}, 3.8801725160420113`*^9, {3.880172633206258*^9, 
   3.880172668057517*^9}, {3.88017286427318*^9, 3.880172905415119*^9}, {
   3.88017312079637*^9, 3.8801732105577908`*^9}, {3.880173298981496*^9, 
   3.880173421095241*^9}, {3.880173681517982*^9, 3.880173682331421*^9}, {
   3.8801742762162457`*^9, 3.880174338424602*^9}, {3.880174612961401*^9, 
   3.880174616287506*^9}},
 CellLabel->
  "In[1041]:=",ExpressionUUID->"bbb9e4a0-d9c6-4386-ac46-3b9bb612cf37"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {
      RowBox[{"-", "2"}], "1", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      "0", "0", "0", "0", "0", "0", "0", "0", "0"},
     {"1", 
      RowBox[{"-", "2"}], "1", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      "0", "0", "0", "0", "0", "0", "0", "0"},
     {"0", "1", 
      RowBox[{"-", "2"}], "1", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      "0", "0", "0", "0", "0", "0", "0"},
     {"0", "0", "1", 
      RowBox[{"-", "2"}], "1", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      "0", "0", "0", "0", "0", "0"},
     {"0", "0", "0", "1", 
      RowBox[{"-", "2"}], "1", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      "0", "0", "0", "0", "0"},
     {"0", "0", "0", "0", "1", 
      RowBox[{"-", "2"}], "1", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      "0", "0", "0", "0"},
     {"0", "0", "0", "0", "0", "1", 
      RowBox[{"-", "2"}], "1", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      "0", "0", "0"},
     {"0", "0", "0", "0", "0", "0", "1", 
      RowBox[{"-", "2"}], "1", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "1", 
      RowBox[{"-", "2"}], "1", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0", "1", 
      RowBox[{"-", "2"}], "1", "0", "0", "0", "0", "0", "0", "0", "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0", "0", "1", 
      RowBox[{"-", "2"}], "1", "0", "0", "0", "0", "0", "0", "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "1", 
      RowBox[{"-", "2"}], "1", "0", "0", "0", "0", "0", "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "1", 
      RowBox[{"-", "2"}], "1", "0", "0", "0", "0", "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "1", 
      RowBox[{"-", "2"}], "1", "0", "0", "0", "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "1", 
      RowBox[{"-", "2"}], "1", "0", "0", "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      "1", 
      RowBox[{"-", "2"}], "1", "0", "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      "0", "1", 
      RowBox[{"-", "2"}], "1", "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      "0", "0", "1", 
      RowBox[{"-", "2"}], "1", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      "0", "0", "0", "1", 
      RowBox[{"-", "2"}], "1"},
     {"0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      "0", "0", "0", "0", "1", 
      RowBox[{"-", "2"}]}
    },
    GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{
  3.8801726578287077`*^9, {3.880172897676754*^9, 3.880172905767115*^9}, {
   3.880173414478598*^9, 3.880173422765028*^9}, 3.880173683219181*^9, 
   3.880174584404175*^9, 3.880174644131755*^9},
 CellLabel->
  "Out[1057]//MatrixForm=",ExpressionUUID->"f8220eaf-f10e-4f63-a6ba-\
ea4f69769410"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {
      RowBox[{"-", "2"}], "1", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0"},
     {"1", 
      RowBox[{"-", "2"}], "1", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      "0", "0", "0", "0", "0", "0", "0", "0", "0", "0"},
     {"0", "1", 
      RowBox[{"-", "2"}], "1", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      "0", "0", "0", "0", "0", "0", "0", "0", "0"},
     {"0", "0", "1", 
      RowBox[{"-", "2"}], "1", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      "0", "0", "0", "0", "0", "0", "0", "0"},
     {"0", "0", "0", "1", 
      RowBox[{"-", "2"}], "1", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      "0", "0", "0", "0", "0", "0", "0"},
     {"0", "0", "0", "0", "1", 
      RowBox[{"-", "2"}], "1", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      "0", "0", "0", "0", "0", "0"},
     {"0", "0", "0", "0", "0", "1", 
      RowBox[{"-", "2"}], "1", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      "0", "0", "0", "0", "0"},
     {"0", "0", "0", "0", "0", "0", "1", 
      RowBox[{"-", "2"}], "1", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      "0", "0", "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "1", 
      RowBox[{"-", "2"}], "1", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      "0", "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0", "1", 
      RowBox[{"-", "2"}], "1", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0", "0", "1", 
      RowBox[{"-", "2"}], "1", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "1", 
      RowBox[{"-", "2"}], "1", "0", "0", "0", "0", "0", "0", "0", "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "1", 
      RowBox[{"-", "2"}], "1", "0", "0", "0", "0", "0", "0", "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "1", 
      RowBox[{"-", "2"}], "1", "0", "0", "0", "0", "0", "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "1", 
      RowBox[{"-", "2"}], "1", "0", "0", "0", "0", "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      "1", 
      RowBox[{"-", "2"}], "1", "0", "0", "0", "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      "0", "1", 
      RowBox[{"-", "2"}], "1", "0", "0", "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      "0", "0", "1", 
      RowBox[{"-", "2"}], "1", "0", "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      "0", "0", "0", "1", 
      RowBox[{"-", "2"}], "1", "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      "0", "0", "0", "0", "1", 
      RowBox[{"-", "2"}], "1", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      "0", "0", "0", "0", "0", "1", 
      RowBox[{"-", "2"}], "1"},
     {"0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      "0", "0", "0", "0", "0", "0", "1", 
      RowBox[{"-", "2"}]}
    },
    GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{
  3.8801726578287077`*^9, {3.880172897676754*^9, 3.880172905767115*^9}, {
   3.880173414478598*^9, 3.880173422765028*^9}, 3.880173683219181*^9, 
   3.880174584404175*^9, 3.8801746441362743`*^9},
 CellLabel->
  "Out[1058]//MatrixForm=",ExpressionUUID->"47ce4fe5-778e-4d6d-a4ad-\
cb0f954fe459"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"0.`", ",", 
   RowBox[{"-", "1.`"}], ",", 
   RowBox[{"-", "1.`"}], ",", "0.`", ",", "0.`", ",", "0.`", ",", "0.`", ",", 
   "0.`", ",", "0.`", ",", "0.`", ",", "0.`", ",", "0.`", ",", "0.`", ",", 
   "0.`", ",", "0.`", ",", "0.`", ",", "0.`", ",", "1.`", ",", "1.`", ",", 
   "0.`"}], "}"}]], "Output",
 CellChangeTimes->{
  3.8801726578287077`*^9, {3.880172897676754*^9, 3.880172905767115*^9}, {
   3.880173414478598*^9, 3.880173422765028*^9}, 3.880173683219181*^9, 
   3.880174584404175*^9, 3.8801746441391373`*^9},
 CellLabel->
  "Out[1059]=",ExpressionUUID->"5cd4ca51-4635-4252-aa77-f937bd951fdd"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
  "1.5238095238095237`", ",", "3.0476190476190474`", ",", 
   "3.5714285714285716`", ",", "3.095238095238096`", ",", "2.61904761904762`",
    ",", "2.1428571428571437`", ",", "1.6666666666666674`", ",", 
   "1.1904761904761914`", ",", "0.7142857142857153`", ",", 
   "0.23809523809523925`", ",", 
   RowBox[{"-", "0.2380952380952368`"}], ",", 
   RowBox[{"-", "0.7142857142857129`"}], ",", 
   RowBox[{"-", "1.190476190476189`"}], ",", 
   RowBox[{"-", "1.666666666666665`"}], ",", 
   RowBox[{"-", "2.142857142857141`"}], ",", 
   RowBox[{"-", "2.6190476190476173`"}], ",", 
   RowBox[{"-", "3.0952380952380936`"}], ",", 
   RowBox[{"-", "3.57142857142857`"}], ",", 
   RowBox[{"-", "3.047619047619046`"}], ",", 
   RowBox[{"-", "1.523809523809523`"}]}], "}"}]], "Output",
 CellChangeTimes->{
  3.8801726578287077`*^9, {3.880172897676754*^9, 3.880172905767115*^9}, {
   3.880173414478598*^9, 3.880173422765028*^9}, 3.880173683219181*^9, 
   3.880174584404175*^9, 3.880174644140921*^9},
 CellLabel->
  "Out[1061]=",ExpressionUUID->"97c67fc8-bdf3-4431-959f-cba2548d6824"],

Cell[BoxData[
 GraphicsBox[{{}, 
   {RGBColor[0.368417, 0.506779, 0.709798], PointSize[0.012833333333333334`], 
    AbsoluteThickness[1.6], PointBox[CompressedData["
1:eJxTTMoPSmViYGAQAWIQDQEf7CXaEoHohz1UwAHC53CAcDkcVD0nqXhO4oHy
BRyMeA4b8ByGyYs42J//bHP+MwuUL+HgDVKuwgjlyzisWwUCv6DmKzgcNwAZ
8BnKV3I4kHt7W+7tZ1C+isOJ55Xznleeg/LVHAog/P0QvobDKoh6KF/LYQ/E
PChfx2ExxD4oX8/BFeKeAxC+gYMlxL1QvqGDLsQ/UL6RgyLEv1C+sYMoJDyg
fBMo/8d+AC4BVV4=
     "]]}, {{}, {}}},
  AspectRatio->NCache[GoldenRatio^(-1), 0.6180339887498948],
  Axes->{True, True},
  AxesLabel->{None, None},
  AxesOrigin->{0., 0},
  DisplayFunction->Identity,
  Frame->{{False, False}, {False, False}},
  FrameLabel->{{None, None}, {None, None}},
  FrameTicks->{{Automatic, Automatic}, {Automatic, Automatic}},
  GridLines->{None, None},
  GridLinesStyle->Directive[
    GrayLevel[0.5, 0.4]],
  Method->{
   "OptimizePlotMarkers" -> True, "OptimizePlotMarkers" -> True, 
    "CoordinatesToolOptions" -> {"DisplayFunction" -> ({
        Identity[
         Part[#, 1]], 
        Identity[
         Part[#, 2]]}& ), "CopiedValueFunction" -> ({
        Identity[
         Part[#, 1]], 
        Identity[
         Part[#, 2]]}& )}},
  PlotRange->{{0., 20}, {-3.57142857142857, 3.5714285714285716`}},
  PlotRangeClipping->True,
  PlotRangePadding->{{
     Scaled[0.02], 
     Scaled[0.02]}, {
     Scaled[0.05], 
     Scaled[0.05]}},
  Ticks->{Automatic, Automatic}]], "Output",
 CellChangeTimes->{
  3.8801726578287077`*^9, {3.880172897676754*^9, 3.880172905767115*^9}, {
   3.880173414478598*^9, 3.880173422765028*^9}, 3.880173683219181*^9, 
   3.880174584404175*^9, 3.880174644187087*^9},
 CellLabel->
  "Out[1062]=",ExpressionUUID->"b6dbdf96-39e0-4bb8-9415-61ea5f7fff3a"]
}, Open  ]],

Cell[BoxData[{
 RowBox[{
  RowBox[{"rhs", " ", "=", " ", 
   RowBox[{"Join", "[", 
    RowBox[{
     RowBox[{"PadRight", "[", 
      RowBox[{
       RowBox[{"PadLeft", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"-", "1."}], ",", 
           RowBox[{"-", "1."}]}], "}"}], ",", " ", "3", ",", " ", "0."}], 
        "]"}], ",", 
       RowBox[{"count", " ", "-", " ", "3"}], ",", " ", "0."}], "]"}], ",", 
     " ", 
     RowBox[{"{", 
      RowBox[{"1.", ",", "1.", ",", "0."}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"rhs", " ", "=", " ", 
   RowBox[{"Join", "[", 
    RowBox[{
     RowBox[{"{", "0.", "}"}], ",", " ", "rhs", ",", " ", 
     RowBox[{"{", "0.", "}"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"left", " ", "=", 
   RowBox[{"solution1", "[", 
    RowBox[{"[", "4", "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"right", " ", "=", " ", 
   RowBox[{"solution1", "[", 
    RowBox[{"[", 
     RowBox[{"count", "-", "3"}], "]"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"rhs", " ", "=", " ", 
   RowBox[{"rhs", " ", "-", " ", 
    RowBox[{"Join", "[", 
     RowBox[{
      RowBox[{"{", "0.", "}"}], ",", 
      RowBox[{"PadRight", "[", 
       RowBox[{
        RowBox[{"Join", "[", 
         RowBox[{
          RowBox[{"PadRight", "[", 
           RowBox[{
            RowBox[{"PadLeft", "[", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"left", ",", 
                RowBox[{
                 RowBox[{"-", "2"}], "*", "left"}], ",", "left"}], "}"}], ",",
               " ", "5", ",", " ", "0."}], "]"}], ",", " ", 
            RowBox[{"count", " ", "-", " ", "5"}], ",", " ", "0."}], "]"}], 
          ",", 
          RowBox[{"{", 
           RowBox[{"right", ",", 
            RowBox[{
             RowBox[{"-", "2"}], "*", "right"}], ",", "right"}], "}"}]}], 
         "]"}], ",", " ", "count", ",", "0."}], "]"}], ",", 
      RowBox[{"{", "0.", "}"}]}], "]"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"rhs", " ", "=", " ", 
   RowBox[{"rhs", "[", 
    RowBox[{"[", 
     RowBox[{"Range", "[", 
      RowBox[{"2", ",", 
       RowBox[{"count", "+", "1"}]}], "]"}], "]"}], "]"}]}], ";"}]}], "Input",\

 CellChangeTimes->{{3.8801064906335907`*^9, 3.880106555265339*^9}, {
   3.8801065906334763`*^9, 3.880106769752624*^9}, 3.88010681388979*^9, {
   3.8801068642562647`*^9, 3.880106874392249*^9}, {3.880106907216131*^9, 
   3.880106980120034*^9}, {3.8801071378876133`*^9, 3.880107147399428*^9}, {
   3.880107363847027*^9, 3.8801073772307673`*^9}, 3.880107478150464*^9, {
   3.880107513422266*^9, 3.880107522734082*^9}, {3.880107562255014*^9, 
   3.880107576893998*^9}, {3.8801076520138597`*^9, 3.880107692517823*^9}, {
   3.880107891701342*^9, 3.880107895293083*^9}, {3.88010801194088*^9, 
   3.88010804125249*^9}, {3.880108071981213*^9, 3.880108112508346*^9}, {
   3.880108149044982*^9, 3.880108155284321*^9}, {3.8801082908042192`*^9, 
   3.88010829558773*^9}, {3.880108649946987*^9, 3.8801086530587*^9}, {
   3.880108691578905*^9, 3.8801086986266117`*^9}, {3.880109409808668*^9, 
   3.880109412304488*^9}, {3.8801103340936823`*^9, 3.880110334238633*^9}, {
   3.880110403430348*^9, 3.8801104188934193`*^9}, {3.880171819644506*^9, 
   3.880171837502036*^9}, {3.880173663153771*^9, 3.880173668734023*^9}, {
   3.880173775409087*^9, 3.880173800691011*^9}, {3.880173833612623*^9, 
   3.880173848210638*^9}, {3.880174170347003*^9, 3.8801742239764833`*^9}, {
   3.8801743460814657`*^9, 3.880174349791876*^9}},
 CellLabel->
  "In[1063]:=",ExpressionUUID->"89ecf626-ae05-42d7-9fb4-d6c4a4b3db13"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"FDiff1DMod", " ", "=", " ", "FDiff1D2"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"FDiff1DMod", " ", "=", " ", 
   RowBox[{"FDiff1DMod", "[", 
    RowBox[{"[", 
     RowBox[{"All", ",", 
      RowBox[{"Join", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"1", ",", "2", ",", "3", ",", "4"}], "}"}], ",", 
        RowBox[{"Range", "[", 
         RowBox[{"6", ",", 
          RowBox[{"count", "-", "3"}]}], "]"}], ",", " ", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"count", " ", "-", "1"}], ",", " ", "count", " ", ",", " ", 
          
          RowBox[{"count", " ", "+", " ", "1"}], ",", " ", 
          RowBox[{"count", " ", "+", " ", "2"}]}], "}"}]}], "]"}]}], "]"}], 
    "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"FDiff1DMod", " ", "=", " ", 
   RowBox[{"FDiff1DMod", "[", 
    RowBox[{"[", 
     RowBox[{"Range", "[", 
      RowBox[{"2", ",", 
       RowBox[{"count", "+", "1"}]}], "]"}], "]"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"solution2", " ", "=", " ", 
   RowBox[{"LinearSolve", "[", 
    RowBox[{"FDiff1DMod", ",", " ", "rhs"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"solution2", " ", "=", " ", 
   RowBox[{"Join", "[", 
    RowBox[{
     RowBox[{"solution2", "[", 
      RowBox[{"[", 
       RowBox[{"Range", "[", 
        RowBox[{"1", ",", "4"}], "]"}], "]"}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"solution1", "[", 
       RowBox[{"[", "4", "]"}], "]"}], "}"}], ",", 
     RowBox[{"solution2", "[", 
      RowBox[{"[", 
       RowBox[{"Range", "[", 
        RowBox[{"5", ",", 
         RowBox[{"count", "-", "4"}]}], "]"}], "]"}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"solution1", "[", 
       RowBox[{"[", 
        RowBox[{"count", "-", "3"}], "]"}], "]"}], "}"}], ",", " ", 
     RowBox[{"solution2", "[", 
      RowBox[{"[", 
       RowBox[{"Range", "[", 
        RowBox[{
         RowBox[{"count", "-", "3"}], ",", "count"}], "]"}], "]"}], "]"}]}], 
    "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"ListPlot", "[", 
  RowBox[{"solution2", " ", "-", " ", 
   RowBox[{"Join", "[", 
    RowBox[{
     RowBox[{"{", "0.", "}"}], ",", "solution1", ",", 
     RowBox[{"{", "0.", "}"}]}], "]"}]}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"ListPlot", "[", "solution2", "]"}]}], "Input",
 CellChangeTimes->CompressedData["
1:eJwd0E8oQwEAx/GHHVyU2JaWtdGehbcdNVxGi1eKWRZvaWrR1iamUDtQk1Ha
FPUUrZWXhiRS01YUxTQnu2z+HVYiy6xQaweN99vh1+f4q2+dZdIwVkoQhIQf
zDvEteH3TMdJeFMGRU6fAs720Q3QplIbYVWozQRT9q15qM0wbkhrCx4oO1f6
oDOeWoND+/oA3KOedyHn3T6EvX5NCF6r1sMwmrXGoF55E4eKCipRlBW8wuSx
OV38bT/Nw4GrzC/UtfQIIrxSq6Ecmg6WZTAvjDZB4e1LM+S+jPVJ3twFUzTw
Z2mED0t+CnojulZIkxNmKK4ZsdzzDr9VjkKHptoGRVLXFEy4B2fg4qrDBUl5
cA6epX88UEIyKzDwEfPCzn41C++6jjZgyaWIg9mdQhDaPse/H9GFXSh74p1m
c0LYLSco+A9N7vhP
  "],
 CellLabel->
  "In[1191]:=",ExpressionUUID->"8dae418e-c650-4535-9c2a-857fd27a27c8"],

Cell[BoxData[
 GraphicsBox[{{}, 
   {RGBColor[0.368417, 0.506779, 0.709798], PointSize[0.012833333333333334`], 
    AbsoluteThickness[1.6], PointBox[CompressedData["
1:eJxTTMoPSmViYGAQA2IQDQEf7CH0BRuogAMqnwONLwDlH4DyRRwYUIAETH4P
hJZBk1eA8jdA5ZXQ+CpofDUofwWUrwHlb4LytaD8HVC+Dpr9elD+CSjfAOYf
KN8QTb0RmnuNYfJQ/5qg8U1h5kH5Zg5ffu97/3vfeRsA35kowg==
     "]]}, {{}, {}}},
  AspectRatio->NCache[GoldenRatio^(-1), 0.6180339887498948],
  Axes->{True, True},
  AxesLabel->{None, None},
  AxesOrigin->{0., 0},
  DisplayFunction->Identity,
  Frame->{{False, False}, {False, False}},
  FrameLabel->{{None, None}, {None, None}},
  FrameTicks->{{Automatic, Automatic}, {Automatic, Automatic}},
  GridLines->{None, None},
  GridLinesStyle->Directive[
    GrayLevel[0.5, 0.4]],
  Method->{
   "OptimizePlotMarkers" -> True, "OptimizePlotMarkers" -> True, 
    "CoordinatesToolOptions" -> {"DisplayFunction" -> ({
        Identity[
         Part[#, 1]], 
        Identity[
         Part[#, 2]]}& ), "CopiedValueFunction" -> ({
        Identity[
         Part[#, 1]], 
        Identity[
         Part[#, 2]]}& )}},
  PlotRange->{{0., 22}, {-8.881784197001252*^-16, 8.881784197001252*^-16}},
  PlotRangeClipping->True,
  PlotRangePadding->{{
     Scaled[0.02], 
     Scaled[0.02]}, {
     Scaled[0.05], 
     Scaled[0.05]}},
  Ticks->{Automatic, Automatic}]], "Output",
 CellChangeTimes->{
  3.880174584478487*^9, {3.880174640882242*^9, 3.880174644281158*^9}, {
   3.880174680649506*^9, 3.880174694993979*^9}, 3.880174774999572*^9, 
   3.880174905003549*^9, 3.880179654409134*^9, 3.880179744723173*^9, {
   3.88017990845606*^9, 3.880179957978956*^9}, {3.8801799997240667`*^9, 
   3.880180064892827*^9}},
 CellLabel->
  "Out[1196]=",ExpressionUUID->"90421fbd-c931-4f2d-a5ae-f48b1ad3206d"],

Cell[BoxData[
 GraphicsBox[{{}, 
   {RGBColor[0.368417, 0.506779, 0.709798], PointSize[0.012833333333333334`], 
    AbsoluteThickness[1.6], PointBox[CompressedData["
1:eJxTTMoPSmViYGAQA2IQDQEf7CH0BRuogINMW6JEW+IPqDiHgxSYz+EA4Qs4
qHlOUvGcxAPlizgY8Rw24DkMk5dwsDv/2eb8ZxYoX8bBG6RchRHKV3BYuwoE
fkHNV3I4ZgAy4DOUr+KwL/f2ttzbz6B8NYdDzyvnPa88B+VrOFRC+PshfC2H
tRD1UL6Owz6IeVC+nsMyiH1QvoGDO8Q9ByB8QwcriHuhfCMHXYh/oHxjBwWI
f6F8EwcRSHhA+aYOgpDwgppv5vDl9773v/edtwEAxyBdwQ==
     "]]}, {{}, {}}},
  AspectRatio->NCache[GoldenRatio^(-1), 0.6180339887498948],
  Axes->{True, True},
  AxesLabel->{None, None},
  AxesOrigin->{0., 0},
  DisplayFunction->Identity,
  Frame->{{False, False}, {False, False}},
  FrameLabel->{{None, None}, {None, None}},
  FrameTicks->{{Automatic, Automatic}, {Automatic, Automatic}},
  GridLines->{None, None},
  GridLinesStyle->Directive[
    GrayLevel[0.5, 0.4]],
  Method->{
   "OptimizePlotMarkers" -> True, "OptimizePlotMarkers" -> True, 
    "CoordinatesToolOptions" -> {"DisplayFunction" -> ({
        Identity[
         Part[#, 1]], 
        Identity[
         Part[#, 2]]}& ), "CopiedValueFunction" -> ({
        Identity[
         Part[#, 1]], 
        Identity[
         Part[#, 2]]}& )}},
  PlotRange->{{0., 22}, {-3.5714285714285694`, 3.571428571428572}},
  PlotRangeClipping->True,
  PlotRangePadding->{{
     Scaled[0.02], 
     Scaled[0.02]}, {
     Scaled[0.05], 
     Scaled[0.05]}},
  Ticks->{Automatic, Automatic}]], "Output",
 CellChangeTimes->{
  3.880174584478487*^9, {3.880174640882242*^9, 3.880174644281158*^9}, {
   3.880174680649506*^9, 3.880174694993979*^9}, 3.880174774999572*^9, 
   3.880174905003549*^9, 3.880179654409134*^9, 3.880179744723173*^9, {
   3.88017990845606*^9, 3.880179957978956*^9}, {3.8801799997240667`*^9, 
   3.880180064927986*^9}},
 CellLabel->
  "Out[1197]=",ExpressionUUID->"227611cc-ad22-4b8b-9a34-408419c459e7"]
}, Open  ]]
},
WindowSize->{1920., 1042.5},
WindowMargins->{{0, Automatic}, {0, Automatic}},
FrontEndVersion->"13.0 for Linux x86 (64-bit) (December 2, 2021)",
StyleDefinitions->"Default.nb",
ExpressionUUID->"9c426147-2841-4f61-838b-ab5bb26f448e"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[580, 22, 5735, 135, 504, "Input",ExpressionUUID->"bbb9e4a0-d9c6-4386-ac46-3b9bb612cf37"],
Cell[6318, 159, 3437, 74, 371, "Output",ExpressionUUID->"f8220eaf-f10e-4f63-a6ba-ea4f69769410"],
Cell[9758, 235, 3945, 82, 406, "Output",ExpressionUUID->"47ce4fe5-778e-4d6d-a4ad-cb0f954fe459"],
Cell[13706, 319, 642, 13, 33, "Output",ExpressionUUID->"5cd4ca51-4635-4252-aa77-f937bd951fdd"],
Cell[14351, 334, 1110, 23, 33, "Output",ExpressionUUID->"97c67fc8-bdf3-4431-959f-cba2548d6824"],
Cell[15464, 359, 1722, 45, 235, "Output",ExpressionUUID->"b6dbdf96-39e0-4bb8-9415-61ea5f7fff3a"]
}, Open  ]],
Cell[17201, 407, 3680, 89, 133, "Input",ExpressionUUID->"89ecf626-ae05-42d7-9fb4-d6c4a4b3db13"],
Cell[CellGroupData[{
Cell[20906, 500, 2946, 80, 154, "Input",ExpressionUUID->"8dae418e-c650-4535-9c2a-857fd27a27c8"],
Cell[23855, 582, 1766, 45, 212, "Output",ExpressionUUID->"90421fbd-c931-4f2d-a5ae-f48b1ad3206d"],
Cell[25624, 629, 1876, 47, 235, "Output",ExpressionUUID->"227611cc-ad22-4b8b-9a34-408419c459e7"]
}, Open  ]]
}
]
*)

